---
import { getCollection } from 'astro:content';
import MainLayout from '../../layouts/MainLayout.astro';
import PostContent from '../../components/PostContent.astro';
import Icon from '../../components/Icon.astro';

// generate paths from existing content entries
export async function getStaticPaths() {
  const entries = await getCollection('posts');
  return entries.map((entry) => {
    return {
      params: { slug: entry.id },
      props: { post: entry },
    };
  });
}

const { post } = Astro.props;

const { pubDate } = post.data;
pubDate.setUTCHours(16); // set pubDate time. 16:00 UTC == 12:00 GMT-4
---

<MainLayout>
  <a href="/blog" class="back-link">
    <span><Icon icon={'arrow-left'} /></span>
    <span> All Posts </span>
  </a>
  <section class="front-matter">
    <h1>{post.data.title}</h1>
    <p class="date">{post.data.pubDate.toDateString()}</p>
    <div class="tag-container">
      {post.data.tags.map((tag) => <p class="tag">{tag}</p>)}
    </div>
    <hr />
  </section>
  <PostContent post={post} />
</MainLayout>
<style>
  .front-matter {
    display: flex;
    flex-direction: column;
    position: relative;
  }

  .back-link {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    width: fit-content;
  }

  .date {
    font-size: 0.9375rem;
  }

  .tag-container {
    display: flex;
    gap: 0.25rem;
  }

  .tag {
    font-size: 0.75rem;
    background-color: var(--clr-accent);
    border-radius: var(--border-radius);
    padding: 0.25rem;
  }
</style>
